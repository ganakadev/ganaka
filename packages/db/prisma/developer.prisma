model Developer {
  id       String @unique @default(uuid())
  username String @id @unique

  runs  Run[]
  token String @unique

  growwApiKey    String? /// @encrypted
  growwApiSecret String? /// @encrypted 

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([token, username])
  @@map("developers")
}

model Run {
  id String @id @default(uuid())

  startTime DateTime
  endTime   DateTime

  completed Boolean    @default(false)
  orders    Order[]
  developer Developer? @relation(fields: [developerId], references: [id], onDelete: Cascade)

  name String?
  tags String[] @default([])

  developerId String?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@index([startTime, endTime, completed])
  @@map("runs")
}

model Order {
  id String @id @default(uuid())

  run Run @relation(fields: [runId], references: [id], onDelete: Cascade)

  nseSymbol       String
  stopLossPrice   Decimal
  takeProfitPrice Decimal
  entryPrice      Decimal
  timestamp       DateTime

  runId     String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([runId, nseSymbol])
  @@map("orders")
}
