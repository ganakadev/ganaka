generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model ShortlistSnapshot {
  id            String        @id @default(uuid())
  timestamp     DateTime      @db.Timestamptz(6)
  shortlistType ShortlistType
  entries       Json // Array of shortlist items with nseSymbol, name, price
  createdAt     DateTime      @default(now()) @db.Timestamptz(6)

  @@index([timestamp])
  @@map("shortlist_snapshots")
}

model QuoteSnapshot {
  id            String        @id @default(uuid())
  timestamp     DateTime      @db.Timestamptz(6)
  nseSymbol     String
  shortlistType ShortlistType // Which shortlist this quote belongs to
  quoteData     Json // Full quote payload from Groww API
  createdAt     DateTime      @default(now()) @db.Timestamptz(6)

  @@index([timestamp])
  @@index([nseSymbol])
  @@index([timestamp, nseSymbol])
  @@map("quote_snapshots")
}

model NiftyQuote {
  id            String   @id @default(uuid())
  timestamp     DateTime @db.Timestamptz(6)
  quoteData     Json // Full NIFTY quote payload
  dayChangePerc Decimal  @db.Decimal(10, 4)
  createdAt     DateTime @default(now()) @db.Timestamptz(6)

  @@index([timestamp])
  @@map("nifty_quotes")
}

model DeveloperToken {
  username  String   @unique
  token     String   @unique
  createdAt DateTime @default(now()) @db.Timestamptz(6)

  @@index([token])
  @@map("developer_tokens")
}

enum ShortlistType {
  TOP_GAINERS
  VOLUME_SHOCKERS
}
